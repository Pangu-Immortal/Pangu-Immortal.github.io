{% extends "admin/pink_base.html" %}
{% load i18n static %}

{% block title %}ç®¡ç†é¢æ¿ - ç›˜å¤å¤§ä»™æ´åºœ{% endblock %}

{% block branding %}
<h1 id="site-name"><a href="{% url 'custom_admin:index' %}">ğŸŒ¸ ç›˜å¤å¤§ä»™æ´åºœåå°</a></h1>
{% endblock %}

{% block content_title %}<h1>ç®¡ç†é¢æ¿</h1>{% endblock %}

{% block content %}
<div class="pink-dashboard pink-animate-fade-in">
    <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
    <div class="pink-grid pink-grid-cols-1 pink-md:grid-cols-2 pink-lg:grid-cols-4 pink-mb-5">
        <div class="pink-card pink-text-center">
            <div class="pink-text-3xl pink-font-bold pink-text-primary pink-mb-2">{{ article_count }}</div>
            <div class="pink-text-medium pink-font-medium">æ€»æ–‡ç« æ•°</div>
        </div>
        <div class="pink-card pink-text-center">
            <div class="pink-text-3xl pink-font-bold pink-text-secondary pink-mb-2">{{ visible_count }}</div>
            <div class="pink-text-medium pink-font-medium">å·²å‘å¸ƒæ–‡ç« </div>
        </div>
        <div class="pink-card pink-text-center">
            <div class="pink-text-3xl pink-font-bold pink-text-primary pink-mb-2">{{ comment_count }}</div>
            <div class="pink-text-medium pink-font-medium">æ€»è¯„è®ºæ•°</div>
        </div>
        <div class="pink-card pink-text-center">
            <div class="pink-text-3xl pink-font-bold pink-text-secondary pink-mb-2">{{ tag_count }}</div>
            <div class="pink-text-medium pink-font-medium">æ ‡ç­¾æ•°é‡</div>
        </div>
    </div>

    <!-- å¿«é€Ÿæ“ä½œ -->
    <div class="pink-card pink-mb-5">
        <div class="pink-card-header">
            <h2 class="pink-card-title pink-text-primary">ğŸš€ å¿«é€Ÿæ“ä½œ</h2>
        </div>
        <div class="pink-card-body">
            <div class="pink-flex pink-flex-wrap pink-gap-3">
                <a href="{% url 'custom_admin:app_article_add' %}" class="pink-btn pink-btn-primary">
                    âœï¸ æ–°å»ºæ–‡ç« 
                </a>
                <a href="{% url 'custom_admin:app_article_changelist' %}" class="pink-btn pink-btn-secondary">
                    ğŸ“‹ æ–‡ç« ç®¡ç†
                </a>
                <a href="{% url 'custom_admin:app_tag_changelist' %}" class="pink-btn pink-btn-secondary">
                    ğŸ·ï¸ æ ‡ç­¾ç®¡ç†
                </a>
                <a href="{% url 'custom_admin:app_comment_changelist' %}" class="pink-btn pink-btn-secondary">
                    ğŸ’¬ è¯„è®ºç®¡ç†
                </a>
            </div>
        </div>
    </div>

    <!-- æœ€è¿‘å†…å®¹ -->
    <div class="pink-grid pink-grid-cols-1 pink-lg:grid-cols-2 pink-gap-5">
        <div class="pink-card">
            <div class="pink-card-header">
                <h2 class="pink-card-title pink-text-primary">ğŸ“ æœ€è¿‘æ–‡ç« </h2>
            </div>
            <div class="pink-card-body">
                {% if recent_articles %}
                <div class="pink-space-y-3">
                    {% for article in recent_articles %}
                    <div class="pink-p-3 pink-rounded-lg pink-bg-hover pink-transition-all pink-duration-300 pink-hover:scale-105">
                        <div class="pink-flex pink-justify-between pink-items-start pink-mb-2">
                            <a href="{% url 'custom_admin:app_article_change' article.pk %}" class="pink-font-semibold pink-text-dark pink-text-decoration-none pink-hover:text-primary">
                                {{ article.title }}
                            </a>
                            <span class="pink-text-sm pink-text-light">{{ article.published_at|date:"Y-m-d H:i" }}</span>
                        </div>
                        <div class="pink-flex pink-justify-between pink-items-center">
                            <span class="pink-status {% if article.is_hidden %}pink-status-draft{% else %}pink-status-published{% endif %}">
                                {{ article.get_is_hidden_display }}
                            </span>
                            {% if article.tags.all %}
                            <div class="pink-flex pink-gap-1 pink-flex-wrap">
                                {% for tag in article.tags.all %}
                                <span class="wx-tag wx-tag--pink">{{ tag.name }}</span>
                                {% endfor %}
                            </div>
                            {% endif %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="pink-text-center pink-py-8">
                    <p class="pink-text-light pink-mb-4">æš‚æ— æ–‡ç« </p>
                    <a href="{% url 'custom_admin:app_article_add' %}" class="pink-btn pink-btn-primary">åˆ›å»ºç¬¬ä¸€ç¯‡æ–‡ç« </a>
                </div>
                {% endif %}
            </div>
        </div>

        <div class="pink-card">
            <div class="pink-card-header">
                <h2 class="pink-card-title pink-text-primary">ğŸ’­ æœ€è¿‘è¯„è®º</h2>
            </div>
            <div class="pink-card-body">
                {% if recent_comments %}
                <div class="pink-space-y-3">
                    {% for comment in recent_comments %}
                    <div class="pink-p-3 pink-rounded-lg pink-bg-hover pink-transition-all pink-duration-300 pink-hover:scale-105">
                        <div class="pink-flex pink-justify-between pink-items-start pink-mb-2">
                            <div>
                                <span class="pink-font-semibold pink-text-dark">{{ comment.nickname }}</span>
                                {% if comment.city %}
                                <span class="pink-text-sm pink-text-light">æ¥è‡ª {{ comment.city }}</span>
                                {% endif %}
                            </div>
                            <span class="pink-text-sm pink-text-light">{{ comment.created_at|date:"Y-m-d H:i" }}</span>
                        </div>
                        <div class="pink-mb-2">
                            <a href="{% url 'admin:app_article_change' comment.article.pk %}" class="pink-text-sm pink-text-primary pink-text-decoration-none">
                                {{ comment.article.title }}
                            </a>
                            <p class="pink-text-sm pink-text-medium pink-mt-1">{{ comment.content|truncatewords:20 }}</p>
                        </div>
                        <div class="pink-flex pink-justify-end">
                            <span class="pink-status {% if comment.is_hidden %}pink-status-draft{% else %}pink-status-published{% endif %}">
                                {{ comment.get_is_hidden_display }}
                            </span>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                {% else %}
                <div class="pink-text-center pink-py-8">
                    <p class="pink-text-light">æš‚æ— è¯„è®º</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<style>
/* è‡ªå®šä¹‰åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœ */
.pink-space-y-3 > * + * {
    margin-top: 0.75rem;
}

.pink-transition-all {
    transition-property: all;
}

.pink-duration-300 {
    transition-duration: 300ms;
}

.pink-hover\:scale-105:hover {
    transform: scale(1.05);
}

.pink-hover\:text-primary:hover {
    color: var(--pink-primary);
}

.pink-text-decoration-none {
    text-decoration: none;
}
</style>
{% endblock %}