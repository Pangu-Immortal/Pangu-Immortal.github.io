<!-- f281eb0e-775d-4f3d-b0f4-2a4c01e6cfa3 a51bf8f3-ad2f-4b85-bb24-bceb9853a094 -->
# 盘古大仙洞府开发计划（实施版）

## 阶段一 后端基础与数据结构（SQLite 版）
- 使用 SQLite 作为开发与运行数据库，零配置。
- 在 `app/models.py` 定义 `Tag`、`Article`、`Comment` 模型；实现图片上传路径、自动水印逻辑（使用 Pillow 在封面等上传时写入《盘古大仙洞府》水印）。
- 生成并执行迁移；配置 `MEDIA_URL/MEDIA_ROOT` 与图片访问。

## 阶段二 管理后台与业务规则
- 在 `app/admin.py` 注册三个模型；为 `ArticleAdmin` 集成 Markdown 编辑器（如 `django-markdownx`），支持预览、发布、隐藏、删除操作。
- 为评论在后台添加审核、批量删除、隐藏、关闭评论区的动作（模型字段支持 `is_hidden`、`allow_comment`）。
- 配置后台列表过滤、搜索、展示关键信息。
- 在 `app/models.py` 或单独模块添加随机头像资源生成脚本，启动时生成 30 个 icon 并存储至 `media/avatars`。

## 阶段三 API 与模板渲染
- 在 `RunProject/urls.py` 引入 `app.urls`；新建 `app/urls.py`。
- 在 `app/views.py` 实现首页、文章列表、详情、评论提交、标签筛选、关于作者视图（MVT 版本），并在 `templates/` 编写对应 `base/index/list/detail/about` 模板。
- 文章详情使用 Markdown 渲染与代码高亮；评论提交接口处理随机昵称缓存、城市定位、头像分配。
- 添加缓存策略与输入校验、防刷逻辑。

## 阶段四 Vue 前端与特效
- 使用 Vite 初始化 `frontend/`，配置 `package.json`、`vite.config.ts` 与 API 代理。
- 构建页面：科技风首页、顶栏 `动态/留言板/关于作者`、左侧标签栏、文章列表卡片、留言板与关于页。
- 集成 mock 数据，保留与后端接口对接的留白；提供标签筛选与留言板发送交互。
- 实现科技指针动效、首页粒子动画、Tab 平滑过渡。

## 阶段五 匿名评论体验与后台联动
- 在后端完善匿名评论缓存（使用 `django.core.cache`，按客户端指纹复用昵称与头像），整合城市定位服务（IP API）。
- 后端允许关闭评论区（文章字段）；前端适配显示/隐藏评论框。
- 添加敏感词过滤、节流、防重复提交；后台可直接删除或隐藏评论实时同步。

## 阶段六 部署与文档
- 编写 `docs/deployment.md`、`docs/local_setup.md` 说明本地与生产部署、依赖安装、环境变量、数据库初始化、后台使用流程。
- 准备 `requirements.txt`、`Pipfile` 或 `poetry` 配置；补充 `npm install` 步骤与构建命令。
- 记录 `gunicorn+nginx` MVT 部署方案、静态与媒体文件处理。
- 提供文章发布流程图文说明、示例数据导入脚本。

### To-dos
- [ ] 定义模型与水印上传逻辑（SQLite）
- [ ] 实现后台 Markdown 发布、隐藏删除与评论管理功能
- [ ] 实现 Django 视图、模板与匿名评论接口
- [ ] 构建 Vue 科技风前端与交互特效
- [ ] 完善匿名评论体验与后台联动
- [ ] 编写部署与使用文档，整理依赖与上线方案

---

## 本地试跑步骤（更新）
1. Conda 环境（已存在可跳过）  
   `conda create -n RunProject python=3.13 -y && conda activate RunProject`
2. 安装依赖  
   `pip install -r requirements.txt`
3. 初始化数据  
   `python manage.py makemigrations && python manage.py migrate`
4. 创建后台账号  
   `python manage.py createsuperuser`  
   或设置 `DJANGO_SUPERUSER_*` 后执行 `python manage.py createsuperuser --noinput`
5. 一键运行  
   `bash scripts/dev.sh`
6. 访问  
   前台 `http://127.0.0.1:8000/` ，后台 `http://127.0.0.1:8000/admin/`

> 生产部署亦可使用 SQLite + 只读静态站点；如需高并发与多实例，后续再迁移 MySQL/PostgreSQL。

